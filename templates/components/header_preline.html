{% load static wagtailsettings_tags wagtailcore_tags wagtailimages_tags %}

<!-- ========== HEADER ========== -->
<header class="{% if header_settings.sticky_header %}sticky top-0 {% endif %}flex flex-wrap lg:justify-start lg:flex-nowrap z-50 w-full {{ header_settings.header_height|default:'py-7' }} bg-white border-b border-gray-200 dark:bg-neutral-900 dark:border-neutral-700">
  <nav class="relative max-w-7xl w-full flex flex-wrap lg:grid lg:grid-cols-12 basis-full items-center px-4 md:px-6 lg:px-8 mx-auto" role="navigation" aria-label="Global">
    <div class="lg:col-span-3 flex items-center">
      <!-- Logo -->
      <a class="flex-none rounded-xl text-xl inline-block font-semibold focus:outline-hidden focus:opacity-80" href="/" aria-label="{{ company_settings.company_name|default:'Brand' }}">
        {% if company_settings.logo %}
          {% image company_settings.logo width-120 as logo_img %}
          <img src="{{ logo_img.url }}" alt="{{ company_settings.company_name|default:'Logo' }}" class="w-28 h-auto">
        {% else %}
          <!-- Default Preline-style logo with company initials -->
          <svg class="w-28 h-auto" width="116" height="32" viewBox="0 0 116 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M33.5696 30.8182V11.3182H37.4474V13.7003H37.6229C37.7952 13.3187 38.0445 12.9309 38.3707 12.5369C38.7031 12.1368 39.134 11.8045 39.6634 11.5398C40.1989 11.2689 40.8636 11.1335 41.6577 11.1335C42.6918 11.1335 43.6458 11.4044 44.5199 11.946C45.3939 12.4815 46.0926 13.291 46.6158 14.3743C47.139 15.4515 47.4006 16.8026 47.4006 18.4276C47.4006 20.0095 47.1451 21.3452 46.6342 22.4347C46.1295 23.518 45.4401 24.3397 44.5661 24.8999C43.6982 25.4538 42.7256 25.7308 41.6484 25.7308C40.8852 25.7308 40.2358 25.6046 39.7003 25.3523C39.1709 25.0999 38.737 24.7829 38.3984 24.4013C38.0599 24.0135 37.8014 23.6226 37.6229 23.2287H37.5028V30.8182H33.5696ZM37.4197 18.4091C37.4197 19.2524 37.5367 19.9879 37.7706 20.6158C38.0045 21.2436 38.343 21.733 38.7862 22.0838C39.2294 22.4285 39.768 22.6009 40.402 22.6009C41.0421 22.6009 41.5838 22.4254 42.027 22.0746C42.4702 21.7176 42.8056 21.2251 43.0334 20.5973C43.2673 19.9633 43.3842 19.2339 43.3842 18.4091C43.3842 17.5904 43.2704 16.8703 43.0426 16.2486C42.8149 15.6269 42.4794 15.1406 42.0362 14.7898C41.593 14.4389 41.0483 14.2635 40.402 14.2635C39.7618 14.2635 39.2202 14.4328 38.777 14.7713C38.34 15.1098 38.0045 15.59 37.7706 16.2116C37.5367 16.8333 37.4197 17.5658 37.4197 18.4091Z" class="fill-black dark:fill-white" fill="currentColor"/>
            <circle cx="13" cy="16.5214" r="5" class="fill-black dark:fill-white" fill="currentColor"/>
          </svg>
        {% endif %}
      </a>
      <!-- End Logo -->

      <div class="ms-1 sm:ms-2">
        <!-- Company name or tagline space -->
      </div>
    </div>

    <!-- Button Group -->
    <div class="flex items-center gap-x-1 lg:gap-x-2 ms-auto py-1 lg:ps-6 lg:order-3 lg:col-span-3">
      {% if header_settings.show_search %}
      <button type="button" class="size-9.5 relative flex justify-center items-center rounded-xl bg-white border border-gray-200 text-black hover:bg-gray-100 focus:outline-hidden focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-white/10 dark:text-white dark:hover:text-white dark:focus:text-white" data-hs-overlay="#search-modal">
        <span class="sr-only">Search</span>
        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
      </button>
      {% endif %}

      {% if header_settings.show_theme_toggle %}
      <button type="button" class="hs-dark-mode-active:hidden hs-dark-mode size-9.5 relative flex justify-center items-center rounded-xl bg-white border border-gray-200 text-black hover:bg-gray-100 focus:outline-hidden focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-white/10 dark:text-white dark:hover:text-white dark:focus:text-white" data-hs-theme-click-value="dark">
        <span class="sr-only">Dark mode</span>
        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
      </button>
      <button type="button" class="hs-dark-mode-active:inline-flex hidden hs-dark-mode size-9.5 relative flex justify-center items-center rounded-xl bg-white border border-gray-200 text-black hover:bg-gray-100 focus:outline-hidden focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:hover:bg-white/10 dark:text-white dark:hover:text-white dark:focus:text-white" data-hs-theme-click-value="light">
        <span class="sr-only">Light mode</span>
        <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="m21 21-4.34-4.34"/><path d="M16 8a6 6 0 0 1 6 6"/><path d="m8 2 1.88 1.88"/><path d="M14.12 3.88 16 2"/><path d="m20 6-1.88-1.88"/></svg>
      </button>
      {% endif %}

      {% if header_settings.show_cta_button %}
      <a href="{{ header_settings.cta_button_url }}" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium text-nowrap rounded-xl border border-transparent bg-primary text-white hover:bg-primary/90 focus:outline-none focus:bg-primary/90 focus:ring-2 focus:ring-primary/25 transition disabled:opacity-50 disabled:pointer-events-none">
        {{ header_settings.cta_button_text }}
      </a>
      {% endif %}

      <div class="lg:hidden">
        <button type="button" class="hs-collapse-toggle size-9.5 flex justify-center items-center text-sm font-semibold rounded-xl border border-gray-200 text-gray-800 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:text-white dark:border-neutral-700 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700" data-hs-collapse="#hs-navbar-collapse-nav" aria-expanded="false" aria-controls="hs-navbar-collapse-nav" aria-label="Toggle navigation">
          <svg class="hs-collapse-open:hidden shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg>
          <svg class="hs-collapse-open:block hidden shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>
    </div>
    <!-- End Button Group -->

    <!-- Collapse -->
    <div id="hs-navbar-collapse-nav" class="hs-collapse hidden lg:!block overflow-hidden transition-all duration-300 basis-full grow lg:grow-0 lg:basis-auto lg:order-2 lg:col-span-6" aria-labelledby="hs-navbar-collapse">
      <div class="flex flex-col gap-y-4 gap-x-0 mt-5 lg:flex-row lg:justify-center lg:items-center lg:gap-y-0 lg:gap-x-7 lg:mt-0">

        <!-- Main Navigation Items (Kontakt & Galleri) -->
        {% for link in main_nav_items %}
          <div>
            {% if request.path == link.url or request.get_full_path == link.url %}
              <a class="relative inline-block text-gray-800 focus:outline-none before:absolute before:bottom-0.5 before:start-0 before:-z-1 before:w-full before:h-1 before:bg-primary dark:text-white" href="{{ link.url }}" aria-current="page"{% if link.open_in_new_tab %} target="_blank" rel="noopener"{% endif %}>
                {{ link.name }}
              </a>
            {% else %}
              <a class="inline-block text-gray-800 hover:text-primary focus:outline-none focus:text-primary dark:text-white dark:hover:text-neutral-300 dark:focus:text-neutral-300" href="{{ link.url }}"{% if link.open_in_new_tab %} target="_blank" rel="noopener"{% endif %}>
                {{ link.name }}
              </a>
            {% endif %}
          </div>
        {% endfor %}

        <!-- Mega Menu - "Flere Sider" -->
        {% if mega_menu_items %}
        <div class="hs-dropdown [--strategy:static] lg:[--strategy:fixed] [--adaptive:none] [--is-collapse:true] lg:[--is-collapse:false]">
          <button id="hs-dropdown-mega-menu" type="button" class="hs-dropdown-toggle flex items-center w-full text-gray-800 hover:text-primary focus:outline-none focus:text-primary font-medium dark:text-white dark:hover:text-neutral-300 dark:focus:text-neutral-300" aria-haspopup="menu" aria-expanded="false" aria-label="Mega Menu">
            Flere Sider
            <svg class="hs-dropdown-open:-rotate-180 lg:hs-dropdown-open:rotate-0 duration-300 shrink-0 size-4 ms-1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
          </button>

          <div class="hs-dropdown-menu transition-[opacity,margin] duration-[0.1ms] lg:duration-[150ms] hs-dropdown-open:opacity-100 opacity-0 relative lg:absolute lg:top-full lg:end-0 lg:start-0 lg:min-w-60 w-full lg:w-80 hidden z-10 lg:mt-2 bg-white lg:shadow-md rounded-lg lg:dark:bg-neutral-800 dark:divide-neutral-700 before:absolute before:-top-4 before:start-0 before:w-full before:h-5 lg:after:absolute lg:after:top-1 lg:after:start-6 lg:after:w-4 lg:after:h-4 lg:after:bg-white lg:after:border-l lg:after:border-t lg:after:border-gray-200 lg:after:rotate-45 lg:after:dark:bg-neutral-800 lg:after:dark:border-neutral-700" role="menu" aria-orientation="vertical" aria-labelledby="hs-dropdown-mega-menu">
            <div class="p-4 lg:p-6">
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">

                <!-- Primary Pages Column -->
                <div class="space-y-3">
                  <h3 class="text-sm font-semibold text-gray-800 dark:text-white mb-3">Sider</h3>
                  {% for link in mega_menu_items|slice:":6" %}
                  <div>
                    <a class="group flex items-center gap-x-3 rounded-lg p-3 text-sm text-gray-800 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 dark:text-neutral-400 dark:hover:bg-neutral-700 dark:hover:text-neutral-300 dark:focus:bg-neutral-700 dark:focus:text-neutral-300" href="{{ link.url }}"{% if link.open_in_new_tab %} target="_blank" rel="noopener"{% endif %}>
                      <div class="bg-primary size-8 flex justify-center items-center rounded-lg">
                        {% if link.link_type == 'external' %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg>
                        {% elif link.link_type == 'email' %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        {% elif link.link_type == 'phone' %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                        {% else %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg>
                        {% endif %}
                      </div>
                      <div class="grow">
                        <p class="font-medium text-gray-800 dark:text-neutral-200">{{ link.name }}</p>
                        {% if link.internal_page.search_description %}
                        <p class="text-sm text-gray-600 dark:text-neutral-400">{{ link.internal_page.search_description|truncatechars:60 }}</p>
                        {% endif %}
                      </div>
                    </a>
                  </div>
                  {% endfor %}
                </div>

                <!-- Additional Pages Column (if more than 6 items) -->
                {% if mega_menu_items|length > 6 %}
                <div class="space-y-3">
                  <h3 class="text-sm font-semibold text-gray-800 dark:text-white mb-3">Flere</h3>
                  {% for link in mega_menu_items|slice:"6:" %}
                  <div>
                    <a class="group flex items-center gap-x-3 rounded-lg p-3 text-sm text-gray-800 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 dark:text-neutral-400 dark:hover:bg-neutral-700 dark:hover:text-neutral-300 dark:focus:bg-neutral-700 dark:focus:text-neutral-300" href="{{ link.url }}"{% if link.open_in_new_tab %} target="_blank" rel="noopener"{% endif %}>
                      <div class="bg-primary size-8 flex justify-center items-center rounded-lg">
                        {% if link.link_type == 'external' %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg>
                        {% elif link.link_type == 'email' %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        {% elif link.link_type == 'phone' %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                        {% else %}
                        <svg class="shrink-0 size-4 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg>
                        {% endif %}
                      </div>
                      <div class="grow">
                        <p class="font-medium text-gray-800 dark:text-neutral-200">{{ link.name }}</p>
                        {% if link.internal_page.search_description %}
                        <p class="text-sm text-gray-600 dark:text-neutral-400">{{ link.internal_page.search_description|truncatechars:60 }}</p>
                        {% endif %}
                      </div>
                    </a>
                  </div>
                  {% endfor %}
                </div>
                {% endif %}

              </div>
            </div>
          </div>
        </div>
        {% endif %}
        <!-- End Mega Menu -->

      </div>
    </div>
    <!-- End Collapse -->
  </nav>
</header>
<!-- ========== END HEADER ========== -->

<!-- Search Modal -->
{% if header_settings.show_search %}
<div id="search-modal" class="hs-overlay hs-overlay-backdrop-open:bg-gray-900/50 hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto" role="dialog" tabindex="-1" aria-labelledby="search-modal-label">
  <div class="hs-overlay-open:opacity-100 hs-overlay-open:duration-500 opacity-0 transition-all sm:max-w-lg sm:w-full m-3 sm:mx-auto">
    <div class="flex flex-col bg-white border shadow-sm rounded-xl dark:bg-neutral-900 dark:border-neutral-700 dark:shadow-neutral-700/70">
      <!-- Header -->
      <div class="flex justify-between items-center py-3 px-4 border-b dark:border-neutral-700">
        <h3 id="search-modal-label" class="font-bold text-gray-800 dark:text-white">
          Søg
        </h3>
        <button type="button" class="size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-none focus:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-700 dark:text-neutral-400 dark:hover:bg-neutral-600 dark:focus:bg-neutral-600" data-hs-overlay="#search-modal" aria-label="Luk">
          <span class="sr-only">Luk</span>
          <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m18 6-12 12"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>
      <!-- End Header -->

      <!-- Body -->
      <div class="p-4">
        <form action="{% url 'search' %}" method="get" role="search">
          <div class="relative">
            <div class="absolute inset-y-0 start-0 flex items-center pointer-events-none z-20 ps-3.5">
              <svg class="shrink-0 size-4 text-gray-400 dark:text-neutral-600" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.34-4.34"/></svg>
            </div>
            <input type="text" name="q" class="py-3 ps-10 pe-4 block w-full border-gray-200 rounded-lg text-sm focus:border-primary focus:ring-primary disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400 dark:placeholder-neutral-500 dark:focus:ring-neutral-600" placeholder="Søg..." aria-label="Søg">
          </div>
          <div class="mt-4">
            <button type="submit" class="w-full py-3 px-4 inline-flex justify-center items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-primary text-white hover:bg-primary/90 focus:outline-none focus:bg-primary/90 focus:ring-2 focus:ring-primary/25 disabled:opacity-50 disabled:pointer-events-none">
              Søg
            </button>
          </div>
        </form>
      </div>
      <!-- End Body -->
    </div>
  </div>
</div>
{% endif %}
<!-- End Search Modal -->

<!-- Preline UI components are initialized automatically via HSStaticMethods.autoInit() in base template -->